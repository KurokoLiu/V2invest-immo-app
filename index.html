<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Invest-IMMO App — v2</title>
  <link rel="stylesheet" href="./styles.css" />

  <!-- Librairie CSV -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js" defer></script>

  <!-- Modules -->
  <script type="module" src="./villes_seed.js"></script>
  <script type="module" src="./loyers_fix.js"></script>
  <script type="module" src="./app.js" defer></script>
</head>

<body>
  <header class="app-header">
    <h1>Invest-IMMO</h1>
    <div class="subtitle">Saisie · Financement · Résultats</div>
  </header>

  <main class="container">
    <!-- SAISIE -->
    <section class="card">
      <h2>Saisie (bien)</h2>
      <div class="grid">

        <!-- Nouvelles colonnes basées sur communes_transport_priorisees.csv -->
        <label>Ville
          <input id="ville" list="villesList" placeholder="Commence à taper…" />
          <datalist id="villesList"></datalist>
        </label>

        <label>Code postal
          <input id="cp" placeholder="ex: 94340" />
        </label>

        <label>Département
          <input id="departement" readonly />
        </label>

        <label>Lignes
          <input id="lignes" readonly />
        </label>

        <label>Temps direct vers Paris (min–max)
          <input id="tempsParis" readonly />
        </label>

        <label>Gare dans la commune
          <input id="gare" readonly />
        </label>

        <!-- Champs existants -->
        <label>Type de bien
          <select id="typeBien">
            <option value="auto">Auto</option>
            <option value="maison">Maison</option>
            <option value="appartement">Appartement</option>
          </select>
        </label>

        <label>Surface habitable (m²)
          <input id="surfaceHabitable" type="number" min="0" step="0.1" />
        </label>

        <label>Surface terrain (m²)
          <input id="surfaceTerrain" type="number" min="0" step="1" />
        </label>

        <label>Prix par m² (à saisir)
          <input id="prixM2" type="number" min="0" step="1" placeholder="Ex: 3200" />
        </label>

        <label>Prix d’achat frais compris (€)
          <input id="prixAchat" type="number" min="0" step="1000" />
        </label>

        <label>Loyer total mensuel autorisé (auto)
          <input id="loyerMensuelAutorise" type="number" step="1" readonly />
        </label>

        <div class="full">
          <div id="badge-loyer" class="badge">Loyer: —</div>
          <div id="hint-intervalle" class="hint">Intervalle 95 %: —</div>
        </div>
      </div>

      <button id="btnMajLoyer" class="btn">Mettre à jour via Carte des loyers</button>
    </section>

    <!-- FINANCEMENT -->
    <section class="card">
      <h2>Financement</h2>
      <div class="grid">
        <label>Montant prêt banque (€)
          <input id="mtBanque" type="number" min="0" step="1000" />
        </label>

        <label>Taux banque (% annuel)
          <input id="txBanque" type="number" min="0" step="0.01" placeholder="Ex: 4" />
        </label>

        <label>Durée prêt banque (années)
          <input id="dureeBanque" type="number" min="1" step="1" value="20" />
        </label>

        <label>Mensualité banque (auto)
          <input id="mensuBanque" type="number" readonly />
        </label>

        <label>Avance SASU (€)
          <input id="mtSasu" type="number" min="0" step="1000" />
        </label>

        <label>Taux SASU (% annuel)
          <input id="txSasu" type="number" min="0" step="0.01" value="3" />
        </label>

        <label>Durée SASU (années)
          <input id="dureeSasu" type="number" min="1" step="1" value="30" />
        </label>

        <label>Mensualité SASU (auto)
          <input id="mensuSasu" type="number" readonly />
        </label>

        <label>Charges & TF mensuelles (€)
          <input id="chargesMensuelles" type="number" min="0" step="1" placeholder="Ex: 2250" />
        </label>

        <label>Coupon investisseur phase 1 (€ / mois)
          <input id="couponP1" type="number" min="0" step="1" value="341" />
        </label>
      </div>
    </section>

    <!-- RÉSULTATS -->
    <section class="card">
      <h2>Résultats</h2>
      <div class="grid">
        <label>Revenus bruts mensuels (saisie ou auto)
          <input id="revenuBrutMensuel" type="number" min="0" step="1" />
        </label>

        <label>Cash-flow net mensuel (phase 1)
          <input id="cfPhase1" type="number" readonly />
        </label>

        <label>Occupation requise pour CF ≥ 0 (phase 1)
          <input id="occSeuil" type="text" readonly />
        </label>

        <label>Cash-flow net mensuel (phase 2)
          <input id="cfPhase2" type="number" readonly />
        </label>
      </div>
      <button id="btnCalcul" class="btn btn-primary">Calculer</button>
    </section>
  </main>

  <footer class="app-footer">
    <span>© 2025 — Invest-IMMO</span>
  </footer>
</body>
</html>
